# Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° DocAgent

Ð’ ÑÑ‚Ð¾Ð¼ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð° Ñ‚ÐµÐºÑƒÑ‰Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¸ Ð¿Ð°Ð¿Ð¾Ðº Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°, Ñ Ð°ÐºÑ†ÐµÐ½Ñ‚Ð¾Ð¼ Ð½Ð° Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð´Ð°Ð½Ð½Ñ‹Ñ….

## ðŸ“‚ ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°

```
/opt/docagent/
â”œâ”€â”€ api/                    # API ÑÐµÑ€Ð²Ð¸ÑÑ‹ (FastAPI)
â”œâ”€â”€ backend/                # Ð‘ÑÐºÐµÐ½Ð´ Ð»Ð¾Ð³Ð¸ÐºÐ°
â”œâ”€â”€ config/                 # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
â”œâ”€â”€ data/                   # Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”‚   â”œâ”€â”€ backups/            # Ð ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¿Ð¸Ð¸ Ð±Ð°Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”‚   â””â”€â”€ osv_revenue_0925/   # Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ¸ (Input/Output)
â”œâ”€â”€ docs/                   # Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
â”œâ”€â”€ finance_core/           # Ð¯Ð´Ñ€Ð¾ Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ (Ð¼Ð¾Ð´ÑƒÐ»Ð¸ Python)
â”œâ”€â”€ frontend/               # Ð¤Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
â”œâ”€â”€ knowledge_base/         # Ð‘Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð·Ð½Ð°Ð½Ð¸Ñ
â”‚   â””â”€â”€ duckdb/             # Ð¤Ð°Ð¹Ð»Ñ‹ DuckDB
â”‚       â””â”€â”€ osv/            # Ð Ð°Ð±Ð¾Ñ‡Ð°Ñ Ð±Ð°Ð·Ð° ÐžÐ¡Ð’ (osv_database.duckdb)
â”œâ”€â”€ scripts/                # Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
â”‚   â””â”€â”€ finance/            # Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ (ÑÐ¼. Ð´ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð½Ð¸Ð¶Ðµ)
â””â”€â”€ workflows/              # ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² (Prefect)
```

## ðŸ“‚ Ð”ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð² (`scripts/finance/`)

ÐŸÐ¾ÑÐ»Ðµ Ñ€ÐµÑ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð²ÑÐµ Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð¿Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑŽ:

```
scripts/finance/
â”œâ”€â”€ config.yaml                 # ÐžÐ±Ñ‰Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²
â”‚
â”œâ”€â”€ etl/                        # Extract, Transform, Load (Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…)
â”‚   â”œâ”€â”€ sync_companies.py       # Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¹ Ñ ArangoDB
â”‚   â”œâ”€â”€ sync_revenue_companies.py # Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¹ Ð¸Ð· Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð¿Ð¾ Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐµ
â”‚   â””â”€â”€ update_company_aliases.py # ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð»Ð¸Ð°ÑÐ¾Ð² ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¹
â”‚
â”œâ”€â”€ osv_import/                 # Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð· ÑÑ‹Ñ€Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐžÐ¡Ð’
â”‚   â”œâ”€â”€ import_osv_improved.py  # ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð² DuckDB
â”‚   â”œâ”€â”€ explore_all_osv.py      # Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ñ„Ð°Ð¹Ð»Ð¾Ð²
â”‚   â”œâ”€â”€ find_all_osv.py         # ÐŸÐ¾Ð¸ÑÐº Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑÑ…
â”‚   â””â”€â”€ analyze_logic.py        # ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”‚
â”œâ”€â”€ consolidation/              # ÐšÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð½Ð¾ÑÑ‚ÑŒ
â”‚   â”œâ”€â”€ consolidated_report.py  # Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
â”‚   â”œâ”€â”€ consolidate.py          # Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸
â”‚   â””â”€â”€ export.py               # Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”‚
â”œâ”€â”€ project1_calculator/        # ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ ÐŸÑ€Ð¾ÐµÐºÑ‚Ð° 1 (Ð¡Ð˜Ð‘Ð£Ð )
â”‚   â”œâ”€â”€ project1_calculator.py  # Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°
â”‚   â”œâ”€â”€ analyze_lots_costs.py   # ÐÐ½Ð°Ð»Ð¸Ð· Ð·Ð°Ñ‚Ñ€Ð°Ñ‚ Ð¿Ð¾ Ð»Ð¾Ñ‚Ð°Ð¼
â”‚   â””â”€â”€ equipment_cost_calculator.py # Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ¸
â”‚
â”œâ”€â”€ revenue_analysis_9_2025/    # ÐÐ½Ð°Ð»Ð¸Ð· Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ¸ Ð·Ð° 9 Ð¼ÐµÑ 2025 (Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°)
â”‚   â”œâ”€â”€ step1_normalize_v2.py   # Ð¨Ð°Ð³ 1: ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð² DuckDB
â”‚   â””â”€â”€ step2_consolidate_v2.py # Ð¨Ð°Ð³ 2: ÐšÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð² Excel
â”‚
â”œâ”€â”€ utils/                      # Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¸ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ°
â”‚   â”œâ”€â”€ inspect_duckdb.py       # ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ð³Ð¾ Ñ‚Ð°Ð±Ð»Ð¸Ñ† DuckDB
â”‚   â”œâ”€â”€ check_arango_companies.py # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¹ Ð² ArangoDB
â”‚   â”œâ”€â”€ debug_accounts.py       # ÐžÑ‚Ð»Ð°Ð´ÐºÐ° ÑÑ‡ÐµÑ‚Ð¾Ð²
â”‚   â””â”€â”€ compare_sources.py      # Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…
â”‚
â””â”€â”€ archive/                    # Ð£ÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ðµ Ð¸Ð»Ð¸ Ñ€Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
    â”œâ”€â”€ load_missing_files.py
    â””â”€â”€ truncate_companies.py
```

## ðŸ—„ï¸ Ð‘Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

*   **DuckDB**: ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ….
    *   ÐŸÑƒÑ‚ÑŒ: `/opt/docagent/knowledge_base/duckdb/osv/osv_database.duckdb`
    *   Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹: `revenue_raw` (Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸), `group_companies` (ÑÐ¿Ð¸ÑÐ¾Ðº Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹).
*   **ArangoDB**: Ð“Ñ€Ð°Ñ„Ð¾Ð²Ð°Ñ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°).
    *   ÐšÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸: `Companies`, `Transactions` (Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÑ‚ÑÑ).

## ðŸ”„ ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ (Workflows)

1.  **ÐÐ½Ð°Ð»Ð¸Ð· Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ¸ (Revenue Analysis)**:
    *   Ð”Ð°Ð½Ð½Ñ‹Ðµ: `data/osv_revenue_0925/input/*.xlsx`
    *   Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ 1: `scripts/finance/revenue_analysis_9_2025/step1_normalize_v2.py` (Excel -> DuckDB)
    *   Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ 2: `scripts/finance/revenue_analysis_9_2025/step2_consolidate_v2.py` (DuckDB -> Excel Report)

2.  **Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð³Ñ€Ð°Ñ„Ð° (Graph Sync)**:
    *   Ð¡ÐºÑ€Ð¸Ð¿Ñ‚: `scripts/finance/etl/sync_revenue_companies.py` (Excel -> ArangoDB Companies)
