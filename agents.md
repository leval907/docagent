# ü§ñ AI Agents Documentation

## 1. get_profit_from_OSV

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–≥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ –ø—Ä–∏–±—ã–ª—è—Ö –∏ —É–±—ã—Ç–∫–∞—Ö (P&L) –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏. –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–æ–π –≤–µ–¥–æ–º–æ—Å—Ç–∏ (–û–°–í) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LLM (GigaChat) –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–∞—Å—á–µ—Ç–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

**–§–∞–π–ª:** `scripts/finance/get_profit_from_OSV.py`

**–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**
```bash
python scripts/finance/get_profit_from_OSV.py "–ù–∞–∑–≤–∞–Ω–∏–µ –ö–æ–º–ø–∞–Ω–∏–∏"
# –∏–ª–∏
python scripts/finance/get_profit_from_OSV.py COMPANY_CODE
```

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**
1.  **–ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–∏:** –ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∫–æ–¥—É –Ω–∞—Ö–æ–¥–∏—Ç `id` –∫–æ–º–ø–∞–Ω–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `master.companies`.
2.  **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –û–°–í –∏–∑ `history.osv_detail` –∏ –æ–±–æ–≥–∞—â–∞–µ—Ç –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Å—á–µ—Ç–æ–≤ –∏–∑ `master.chart_of_accounts`.
3.  **–ê–Ω–∞–ª–∏–∑ (LLM):** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ GigaChat —Å –ø—Ä–æ—Å—å–±–æ–π —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å P&L –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (Revenue, Cost of Goods, Overheads –∏ –¥—Ä.).
4.  **–ü–∞—Ä—Å–∏–Ω–≥:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç JSON-–æ—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏, –≤–∫–ª—é—á–∞—è "–Ω–µ—á–µ—Ç–∫–æ–µ" —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω –ø–æ–ª–µ–π (fuzzy matching).
5.  **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:**
    *   –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ –≤ –ª–æ–≥-—Ñ–∞–π–ª `gigachat.log`.
    *   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É `analytics.profit_v`.

**–ü—Ä–æ–º–ø—Ç –¥–ª—è GigaChat:**

```text
–¢—ã - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç –æ –ø—Ä–∏–±—ã–ª—è—Ö –∏ —É–±—ã—Ç–∫–∞—Ö (P&L) –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–æ–π –≤–µ–¥–æ–º–æ—Å—Ç–∏ (–û–°–í).

–í–æ—Ç –¥–∞–Ω–Ω—ã–µ –û–°–í –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ "{company_name}":
{osv_text}

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ–±–æ—Ä–æ—Ç—ã –ø–æ —Å—á–µ—Ç–∞–º (–æ–±—ã—á–Ω–æ 90, 91, 20, 26, 44 –∏ –¥—Ä—É–≥–∏–µ —Å—á–µ—Ç–∞ —É—á–µ—Ç–∞ –∑–∞—Ç—Ä–∞—Ç –∏ –≤—ã—Ä—É—á–∫–∏).
–†–∞—Å—Å—á–∏—Ç–∞–π —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –≤–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –°–¢–†–û–ì–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON. –ù–µ –ø–∏—à–∏ –Ω–∏–∫–∞–∫–æ–≥–æ –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, —Ç–æ–ª—å–∫–æ JSON.

–ü–æ–ª—è JSON –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å (–∑–Ω–∞—á–µ–Ω–∏—è - —á–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π):
- "Revenue" (–í—ã—Ä—É—á–∫–∞)
- "Cost of Goods" (–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å)
- "Overheads" (–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã)
- "Leasing" (–õ–∏–∑–∏–Ω–≥)
- "Extraordinary Income/Expenses" (–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã/—Ä–∞—Å—Ö–æ–¥—ã)
- "Interest Paid" (–ü—Ä–æ—Ü–µ–Ω—Ç—ã –∫ —É–ø–ª–∞—Ç–µ)
- "Depreciation & Amortisation" (–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è)
- "Tax Paid" (–ù–∞–ª–æ–≥–∏)
- "Dividends Paid" (–î–∏–≤–∏–¥–µ–Ω–¥—ã)
- "message" (–°—Ç—Ä–æ–∫–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ—è—Å–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç—ã)

–í–ê–ñ–ù–û:
1. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ JSON (// –∏–ª–∏ #).
2. –í—Å–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (—Å–ª–æ–∂–µ–Ω–∏–µ, –≤—ã—á–∏—Ç–∞–Ω–∏–µ) –≤—ã–ø–æ–ª–Ω–∏ —Å–∞–º –∏ –∑–∞–ø–∏—à–∏ —Ç–æ–ª—å–∫–æ –∏—Ç–æ–≥–æ–≤–æ–µ —á–∏—Å–ª–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ.
3. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å—É–º–º—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∏—Å–µ–ª, –¥–æ–±–∞–≤—å –ø–æ–ª–µ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º "_detail" (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Overheads_detail") –∏ –ø–µ—Ä–µ—á–∏—Å–ª–∏ —Å–ª–∞–≥–∞–µ–º—ã–µ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —á–∏—Å–µ–ª.
4. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –Ω–µ—Ç, —Å—Ç–∞–≤—å 0.0.

–ü—Ä–∏–º–µ—Ä:
{
  "Overheads": 11679065.65,
  "Overheads_detail": [8722594.30, 2956471.35],
  "Revenue": 1000.0
}
```
