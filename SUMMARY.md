# ‚úÖ DocAgent - –ò—Ç–æ–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
DocAgent/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ wrapper_crawler.py      # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ markdown-crawler
‚îÇ   ‚îú‚îÄ‚îÄ postprocess.py           # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ YAML –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ build_index.py           # –°–æ–∑–¥–∞–Ω–∏–µ JSON –∏–Ω–¥–µ–∫—Å–æ–≤
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ sources.yaml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ test_crawler.py          # –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ knowledge_base/              # –í—ã—Ö–æ–¥–Ω—ã–µ markdown —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ logs/                        # –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã
‚îú‚îÄ‚îÄ venv/                        # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îî‚îÄ‚îÄ markdown-crawler/        # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
‚îú‚îÄ‚îÄ Dockerfile                   # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ –ø–∞—Ä—Å–µ—Ä–∞
‚îú‚îÄ‚îÄ docker-compose.yml           # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ setup.ps1                    # –ê–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ (Windows)
‚îú‚îÄ‚îÄ setup.sh                     # –ê–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ (Linux/Mac)
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

### 2. ‚úÖ –ü–∞—Ä—Å–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (`wrapper_crawler.py`)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ YAML
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ depth, delay, include/exclude —Ñ–∏–ª—å—Ç—Ä–æ–≤
- Dry-run —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ markdown-crawler API –Ω–∞–ø—Ä—è–º—É—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
python scripts/wrapper_crawler.py --list

# –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python scripts/wrapper_crawler.py --app dbgpt

# –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
python scripts/wrapper_crawler.py --all

# Dry-run —Ç–µ—Å—Ç
python scripts/wrapper_crawler.py --app dbgpt --dry-run
```

### 3. ‚úÖ Postprocessor (`postprocess.py`)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ YAML front matter –≤ markdown —Ñ–∞–π–ª—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:
  - –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  - URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, —Å—Å—ã–ª–æ–∫
  - –Ø–∑—ã–∫–∏ –∫–æ–¥–∞ –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö
  - SHA256 —Ö–µ—à —Ñ–∞–π–ª–∞
  - –î–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ü—Ä–æ–ø—É—Å–∫ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- Force —Ä–µ–∂–∏–º –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```yaml
---
title: "First RAG with AWEL"
source: "https://docs.dbgpt.cn/docs/awel/cookbook/first_rag"
app: "dbgpt"
app_full_name: "DB-GPT"
category: "ai-frameworks"
tags:
  - "awel"
  - "rag"
date_crawled: "2025-11-08T23:45:00"
word_count: 1250
has_code: true
code_languages: ["python", "bash"]
file_hash: "abc123..."
---
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python scripts/postprocess.py --app dbgpt

# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ
python scripts/postprocess.py --all

# –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
python scripts/postprocess.py --app dbgpt --force
```

### 4. ‚úÖ Indexer (`build_index.py`)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ JSON –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —Å–ª–æ–≤–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–µ–≥–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω–¥–µ–∫—Å–∞:**
```json
{
  "app": "dbgpt",
  "version": "1.0.0",
  "last_update": "2025-11-08T23:50:00Z",
  "total_pages": 15,
  "total_words": 18500,
  "categories": {"cookbook": 12, "api": 3},
  "tags": ["awel", "rag", "agents"],
  "pages": [...]
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò–Ω–¥–µ–∫—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python scripts/build_index.py --app dbgpt

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
python scripts/build_index.py --all

# –ü–æ–∏—Å–∫
python scripts/build_index.py --search "RAG" --app dbgpt
```

### 5. ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# Windows
.\setup.ps1

# Linux/Mac
bash setup.sh
```

–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–∑–¥–∞—é—Ç `venv`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ö–ª–æ–Ω–∏—Ä—É—é—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç markdown-crawler
- –ì–æ—Ç–æ–≤—è—Ç –ø—Ä–æ–µ–∫—Ç –∫ —Ä–∞–±–æ—Ç–µ

### 6. ‚úÖ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–∞—Ä—Å–µ—Ä–∞:**
- Python 3.11
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- markdown-crawler
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: knowledge_base, logs, config

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑
docker-compose build docagent

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
docker-compose run --rm docagent scripts/wrapper_crawler.py --app dbgpt

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
docker-compose run --rm docagent scripts/postprocess.py --app dbgpt
docker-compose run --rm docagent scripts/build_index.py --app dbgpt
```

### 7. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

–§–∞–π–ª `config/sources.yaml` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ: URL, depth, delay, filters
- –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ–≥–∏
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üîß –ü–æ–ª–Ω—ã–π pipeline

```bash
# 1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate  # –∏–ª–∏ .\venv\Scripts\Activate.ps1

# 2. –ü–∞—Ä—Å–∏–Ω–≥
python scripts/wrapper_crawler.py --app dbgpt

# 3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
python scripts/postprocess.py --app dbgpt

# 4. –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å
python scripts/build_index.py --app dbgpt

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
ls knowledge_base/dbgpt/
cat knowledge_base/dbgpt/index.json
```

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| –ü–∞—Ä—Å–µ—Ä (wrapper) | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ API |
| Postprocessor | ‚úÖ | YAML –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ |
| Indexer | ‚úÖ | JSON –∏–Ω–¥–µ–∫—Å—ã |
| –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ | ‚úÖ | venv + setup —Å–∫—Ä–∏–ø—Ç—ã |
| Docker | ‚úÖ | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ |
| –¢–µ—Å—Ç—ã | ‚úÖ | test_crawler.py |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | ‚úÖ | README, QUICK_START, DOCKER |

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏:

1. **n8n –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**
   - –°–æ–∑–¥–∞—Ç—å workflow –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –¢—Ä–∏–≥–≥–µ—Ä—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

2. **Flowise RAG**
   - –ó–∞–≥—Ä—É–∑–∫–∞ markdown –≤ Document Loader
   - –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ embeddings
   - –°–æ–∑–¥–∞–Ω–∏–µ QA –∞–≥–µ–Ω—Ç–∞

3. **Qdrant Vector DB**
   - –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫

4. **OpenSPG Knowledge Graph**
   - –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π
   - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ —Å–≤—è–∑–µ–π

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
   - –ó–∞–ø—É—Å–∫–∞—Ç—å –ø–∞—Ä—Å–µ—Ä —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é —á–µ—Ä–µ–∑ cron –∏–ª–∏ n8n
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ file_hash

2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:**
   - –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ `sources.yaml`
   - LangChain, LlamaIndex, HuggingFace –∏ —Ç.–¥.

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ª–æ–≥–∏ –≤ `logs/`
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –°–æ–±–∏—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ indexer

## üìù –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **SSL –æ—à–∏–±–∫–∏** –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∞–π—Ç–æ–≤
   - **–†–µ—à–µ–Ω–∏–µ**: –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSL verify

2. **–°–∫–æ—Ä–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç delay –∏ num_threads
   - **–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–∞—à–∏–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏!** üéâ
